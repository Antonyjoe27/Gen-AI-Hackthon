<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>GenAI Misinformation Mentor (Local)</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>GenAI Misinformation Mentor (Local Demo)</h1>

    <section>
      <h2>Quick Text Analyze</h2>
      <textarea id="textInput" placeholder="Paste text..."></textarea>
      <input id="userId" placeholder="user id (optional)" />
      <button id="analyzeBtn">Analyze</button>
      <pre id="outText"></pre>
    </section>

    <section>
      <h2>Upload Image</h2>
      <input id="imageInput" type="file" accept="image/*" />
      <button id="imageBtn">Upload & Analyze</button>
      <pre id="outImage"></pre>
    </section>

    <section>
      <h2>Upload Audio</h2>
      <input id="audioInput" type="file" accept="audio/*" />
      <button id="audioBtn">Transcribe & Analyze</button>
      <pre id="outAudio"></pre>
    </section>

    <section>
      <h2>Simulations</h2>
      <input id="simSeed" placeholder="scenario seed e.g., fake vaccine cure" />
      <button id="simStart">Start</button>
      <pre id="simOut"></pre>
    </section>

    <section>
      <h2>Heatmap (Hotspots)</h2>
      <button id="mapBtn">Load Hotspots</button>
      <pre id="mapOut"></pre>
    </section>

    <aside>
      <h3>Leaderboard</h3>
      <ul id="leaderboard"></ul>
    </aside>
  </div>

<script>
async function postForm(url, form) {
  const resp = await fetch(url, {method:'POST', body:form});
  return resp.json();
}

document.getElementById('analyzeBtn').onclick = async ()=>{
  const text = document.getElementById('textInput').value;
  const userId = document.getElementById('userId').value;
  let form = new FormData();
  form.append('content', text);
  if(userId) form.append('user_id', userId);
  const data = await postForm('/api/analyze/text', form);
  document.getElementById('outText').innerText = JSON.stringify(data, null, 2);
  loadLeaderboard();
}

document.getElementById('imageBtn').onclick = async ()=>{
  const f = document.getElementById('imageInput').files[0];
  const form = new FormData();
  form.append('image', f);
  const data = await postForm('/api/analyze/image', form);
  document.getElementById('outImage').innerText = JSON.stringify(data, null, 2);
}

document.getElementById('audioBtn').onclick = async ()=>{
  const f = document.getElementById('audioInput').files[0];
  const form = new FormData();
  form.append('audio', f);
  const data = await postForm('/api/analyze/audio', form);
  document.getElementById('outAudio').innerText = JSON.stringify(data, null, 2);
}

document.getElementById('simStart').onclick = async ()=>{
  const seed = document.getElementById('simSeed').value || "fake scam in a town";
  let form = new FormData();
  form.append('seed', seed);
  const data = await postForm('/api/sim/create', form);
  document.getElementById('simOut').innerText = JSON.stringify(data, null, 2);
}

document.getElementById('mapBtn').onclick = async ()=>{
  const resp = await fetch('/api/heatmap');
  const data = await resp.json();
  document.getElementById('mapOut').innerText = JSON.stringify(data, null, 2);
}

async function loadLeaderboard(){
  const resp = await fetch('/');
  const html = await resp.text();
  // simpler: call an endpoint not implemented; instead request leaderboard via page reload
  // We'll call a simple endpoint if needed later
}
</script>
</body>
</html>
